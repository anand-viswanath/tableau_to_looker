view: train {   sql_table_name: public.train ;;       dimension: row_id {     type: number     sql: ${TABLE}.row_id ;;     primary_key: yes   }    dimension: order_id {     type: string     sql: ${TABLE}.order_id ;;   }    dimension_group: order {     type: time     timeframes: [raw, date, week, month, quarter, year]     convert_tz: no     datatype: date     sql: ${TABLE}.order_date ;;   }    dimension_group: ship {     type: time     timeframes: [raw, date, week, month, quarter, year]     convert_tz: no     datatype: date     sql: ${TABLE}.ship_date ;;   }    dimension: ship_mode {     type: string     sql: ${TABLE}.ship_mode ;;   }    dimension: customer_id {     type: string     sql: ${TABLE}.customer_id ;;   }    dimension: segment {     type: string     sql: ${TABLE}.segment ;;   }    dimension: country {     type: string     map_layer_name: countries     sql: ${TABLE}.country ;;   }    dimension: city {     type: string     sql: ${TABLE}.city ;;   }    dimension: state {     type: string     map_layer_name: us_states     sql: ${TABLE}.state ;;   }    dimension: postal_code {     type: zipcode     sql: ${TABLE}.postal_code ;;   }    dimension: region {     type: string     sql: ${TABLE}.region ;;   }    dimension: product_id {     type: string     sql: ${TABLE}.product_id ;;   }    dimension: category {     type: string     sql: ${TABLE}.category ;;   }    dimension: sub_category {     type: string     sql: ${TABLE}.sub_category ;;   }    dimension: sales_dim {     type: number     hidden: yes     sql: ${TABLE}.sales ;;   }    dimension: monthname {     type: string     sql: ${TABLE}.monthname ;;   }    dimension: year_dim {     type: number     sql: ${TABLE}.year ;;   }    dimension: product_type {     type: string     sql: ${TABLE}.product_type ;;   }    dimension: product_name {     type: string     sql: ${TABLE}.product_name ;;   }    dimension: name {     type: string     label: "Customer Name"     sql: ${TABLE}.name ;;   }
  dimension: profit_raw {     type: number     hidden: yes     sql: ${sales_dim} * 0.2 ;;   }
  measure: total_sales {     type: sum     sql: ${sales_dim} ;;
  value_format_name: usd     drill_fields: [category, sub_category, product_name]   }    measure: total_profit {     type: sum     sql: ${profit_raw} ;;     value_format_name: usd     label: "Total Profit"   }    measure: profit_margin {     type: number     sql: ${total_profit} / NULLIF(${total_sales}, 0) ;;     value_format_name: percent_2     label: "Profit Margin"   }    measure: total_orders {     type: count_distinct     sql: ${order_id} ;;     label: "Total Orders"   }    measure: count {     type: count     drill_fields: [row_id, product_name, name]   } }
